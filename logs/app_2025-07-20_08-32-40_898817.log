2025-07-20 08:32:40.916 | INFO     | __main__:main:160 | 启动服务: host=0.0.0.0, port=8000, debug=False
2025-07-20 08:32:40.936 | INFO     | agent_memory_system.utils.logger:info:176 | API服务启动
2025-07-20 08:32:40.937 | INFO     | agent_memory_system.utils.logger:info:176 | API服务启动
2025-07-20 08:32:41.046 | INFO     | agent_memory_system.utils.logger:info:176 | WebSocket客户端连接: 45de07db-0786-4f98-941a-0be3d664671d
2025-07-20 08:33:41.695 | INFO     | agent_memory_system.utils.logger:info:176 | WebSocket客户端断开: 45de07db-0786-4f98-941a-0be3d664671d
2025-07-20 08:33:43.292 | INFO     | agent_memory_system.utils.logger:info:176 | WebSocket客户端连接: 8c02fe77-7ed9-4c67-9627-8aa09fa94dc5
2025-07-20 08:33:47.552 | INFO     | agent_memory_system.utils.logger:info:176 | 收到WebSocket消息: {'type': 'message', 'content': 'hi', 'timestamp': '2025-07-20T08:33:41.416Z'}
2025-07-20 08:33:47.553 | INFO     | agent_memory_system.utils.logger:info:176 | 处理后的消息格式: {'type': 'message', 'data': {'content': 'hi'}, 'timestamp': '2025-07-20T08:33:41.416Z'}
2025-07-20 08:33:47.554 | INFO     | agent_memory_system.utils.logger:info:176 | 解析后的消息: type=message, data={'content': 'hi'}
2025-07-20 08:33:47.554 | INFO     | agent_memory_system.utils.logger:info:176 | 开始处理消息类型: message
2025-07-20 08:33:47.554 | INFO     | agent_memory_system.utils.logger:info:176 | process_websocket_message: 开始处理消息类型 message
2025-07-20 08:33:47.555 | INFO     | agent_memory_system.utils.logger:info:176 | 处理聊天消息，内容: hi
2025-07-20 08:33:47.555 | ERROR    | agent_memory_system.utils.logger:error:182 | 向量检索失败: 'MemoryQuery' object has no attribute 'content'
2025-07-20 08:33:47.556 | ERROR    | agent_memory_system.utils.logger:error:182 | 图检索失败: 'MemoryQuery' object has no attribute 'memory_ids'
2025-07-20 08:33:47.645 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:33:51.647 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:33:55.648 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:33:55.649 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM调用失败: RetryError[<Future at 0x7ae0e85e4520 state=finished raised APIRemovedInV1>]
2025-07-20 08:33:55.650 | ERROR    | agent_memory_system.utils.logger:error:182 | 存储记忆失败: store_memory() missing 1 required positional argument: 'memory_type'
2025-07-20 08:33:55.651 | INFO     | agent_memory_system.utils.logger:info:176 | 处理完成，准备发送响应: {'type': 'message', 'data': {'content': '抱歉，我暂时无法处理您的请求。错误信息: RetryError[<Future at 0x7ae0e85e4520 state=finished raised APIRemovedInV1>]'}, 'timestamp': '2025-07-20T08:33:55.650831', 'success': True, 'error': None}
2025-07-20 08:33:55.653 | INFO     | agent_memory_system.utils.logger:info:176 | 响应已发送
2025-07-20 08:34:11.884 | INFO     | agent_memory_system.utils.logger:info:176 | 收到WebSocket消息: {'type': 'settings', 'settings': {'provider': 'ollama', 'importanceThreshold': '5', 'retentionDays': '7', 'ollamaBaseUrl': 'http://localhost:11434', 'ollamaModel': 'deepseek-r1:1.5b'}}
2025-07-20 08:34:11.884 | INFO     | agent_memory_system.utils.logger:info:176 | 解析后的消息: type=settings, data=None
2025-07-20 08:34:11.885 | INFO     | agent_memory_system.utils.logger:info:176 | 开始处理消息类型: settings
2025-07-20 08:34:11.885 | INFO     | agent_memory_system.utils.logger:info:176 | process_websocket_message: 开始处理消息类型 settings
2025-07-20 08:34:11.885 | ERROR    | agent_memory_system.utils.logger:error:182 | 处理WebSocket消息失败: 'NoneType' object has no attribute 'get'
2025-07-20 08:34:11.886 | INFO     | agent_memory_system.utils.logger:info:176 | 处理完成，准备发送响应: {'type': 'error', 'data': {'message': '处理消息失败', 'detail': "'NoneType' object has no attribute 'get'"}, 'timestamp': '2025-07-20T08:34:11.886382', 'success': True, 'error': None}
2025-07-20 08:34:11.887 | INFO     | agent_memory_system.utils.logger:info:176 | 响应已发送
2025-07-20 08:34:20.344 | INFO     | agent_memory_system.utils.logger:info:176 | 收到WebSocket消息: {'type': 'message', 'content': 'hi', 'timestamp': '2025-07-20T08:34:12.481Z'}
2025-07-20 08:34:20.345 | INFO     | agent_memory_system.utils.logger:info:176 | 处理后的消息格式: {'type': 'message', 'data': {'content': 'hi'}, 'timestamp': '2025-07-20T08:34:12.481Z'}
2025-07-20 08:34:20.346 | INFO     | agent_memory_system.utils.logger:info:176 | 解析后的消息: type=message, data={'content': 'hi'}
2025-07-20 08:34:20.346 | INFO     | agent_memory_system.utils.logger:info:176 | 开始处理消息类型: message
2025-07-20 08:34:20.346 | INFO     | agent_memory_system.utils.logger:info:176 | process_websocket_message: 开始处理消息类型 message
2025-07-20 08:34:20.347 | INFO     | agent_memory_system.utils.logger:info:176 | 处理聊天消息，内容: hi
2025-07-20 08:34:20.347 | ERROR    | agent_memory_system.utils.logger:error:182 | 向量检索失败: 'MemoryQuery' object has no attribute 'content'
2025-07-20 08:34:20.348 | ERROR    | agent_memory_system.utils.logger:error:182 | 图检索失败: 'MemoryQuery' object has no attribute 'memory_ids'
2025-07-20 08:34:20.370 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:34:24.372 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:34:28.372 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:34:28.373 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM调用失败: RetryError[<Future at 0x7ae0e859bd90 state=finished raised APIRemovedInV1>]
2025-07-20 08:34:28.373 | ERROR    | agent_memory_system.utils.logger:error:182 | 存储记忆失败: store_memory() missing 1 required positional argument: 'memory_type'
2025-07-20 08:34:28.374 | INFO     | agent_memory_system.utils.logger:info:176 | 处理完成，准备发送响应: {'type': 'message', 'data': {'content': '抱歉，我暂时无法处理您的请求。错误信息: RetryError[<Future at 0x7ae0e859bd90 state=finished raised APIRemovedInV1>]'}, 'timestamp': '2025-07-20T08:34:28.374045', 'success': True, 'error': None}
2025-07-20 08:34:28.374 | INFO     | agent_memory_system.utils.logger:info:176 | 响应已发送
2025-07-20 08:34:49.461 | INFO     | agent_memory_system.utils.logger:info:176 | WebSocket客户端断开: 8c02fe77-7ed9-4c67-9627-8aa09fa94dc5
2025-07-20 08:34:49.563 | INFO     | agent_memory_system.utils.logger:info:176 | 缓存存储连接池已关闭
2025-07-20 08:34:49.563 | INFO     | agent_memory_system.utils.logger:info:176 | 记忆管理器已关闭
2025-07-20 08:34:49.564 | INFO     | agent_memory_system.utils.logger:info:176 | 缓存存储连接池已关闭
2025-07-20 08:34:49.564 | INFO     | agent_memory_system.utils.logger:info:176 | 记忆管理器已关闭
