2025-07-20 08:38:35.543 | INFO     | __main__:main:160 | 启动服务: host=0.0.0.0, port=8000, debug=False
2025-07-20 08:38:35.568 | INFO     | agent_memory_system.utils.logger:info:176 | API服务启动
2025-07-20 08:38:35.569 | INFO     | agent_memory_system.utils.logger:info:176 | API服务启动
2025-07-20 08:38:40.155 | INFO     | agent_memory_system.utils.logger:info:176 | WebSocket客户端连接: 99d2ea45-bce6-4eff-9ba6-4586c40472f0
2025-07-20 08:38:42.504 | INFO     | agent_memory_system.utils.logger:info:176 | 收到WebSocket消息: {'type': 'message', 'content': 'hi', 'timestamp': '2025-07-20T08:38:35.753Z'}
2025-07-20 08:38:42.505 | INFO     | agent_memory_system.utils.logger:info:176 | 处理后的消息格式: {'type': 'message', 'data': {'content': 'hi'}, 'timestamp': '2025-07-20T08:38:35.753Z'}
2025-07-20 08:38:42.505 | INFO     | agent_memory_system.utils.logger:info:176 | 解析后的消息: type=message, data={'content': 'hi'}
2025-07-20 08:38:42.505 | INFO     | agent_memory_system.utils.logger:info:176 | 开始处理消息类型: message
2025-07-20 08:38:42.506 | INFO     | agent_memory_system.utils.logger:info:176 | process_websocket_message: 开始处理消息类型 message
2025-07-20 08:38:42.506 | INFO     | agent_memory_system.utils.logger:info:176 | 处理聊天消息，内容: hi
2025-07-20 08:38:42.506 | ERROR    | agent_memory_system.utils.logger:error:182 | 向量检索失败: 'MemoryQuery' object has no attribute 'content'
2025-07-20 08:38:42.507 | ERROR    | agent_memory_system.utils.logger:error:182 | 图检索失败: 'MemoryQuery' object has no attribute 'memory_ids'
2025-07-20 08:38:42.560 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:38:46.562 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:38:53.499 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:38:53.501 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM调用失败: RetryError[<Future at 0x7935b8122430 state=finished raised APIRemovedInV1>]
2025-07-20 08:38:53.502 | ERROR    | agent_memory_system.utils.logger:error:182 | 存储记忆失败: store_memory() missing 1 required positional argument: 'memory_type'
2025-07-20 08:38:53.503 | INFO     | agent_memory_system.utils.logger:info:176 | 处理完成，准备发送响应: {'type': 'message', 'data': {'content': '抱歉，我暂时无法处理您的请求。错误信息: RetryError[<Future at 0x7935b8122430 state=finished raised APIRemovedInV1>]'}, 'timestamp': '2025-07-20T08:38:53.503298', 'success': True, 'error': None}
2025-07-20 08:38:53.505 | INFO     | agent_memory_system.utils.logger:info:176 | 响应已发送
2025-07-20 08:38:56.181 | INFO     | agent_memory_system.utils.logger:info:176 | 收到WebSocket消息: {'type': 'settings', 'settings': {'provider': 'ollama', 'importanceThreshold': '5', 'retentionDays': '7', 'ollamaBaseUrl': 'http://localhost:11434', 'ollamaModel': 'deepseek-r1:1.5b'}}
2025-07-20 08:38:56.182 | INFO     | agent_memory_system.utils.logger:info:176 | 解析后的消息: type=settings, data=None
2025-07-20 08:38:56.182 | INFO     | agent_memory_system.utils.logger:info:176 | 开始处理消息类型: settings
2025-07-20 08:38:56.183 | INFO     | agent_memory_system.utils.logger:info:176 | process_websocket_message: 开始处理消息类型 settings
2025-07-20 08:38:56.183 | ERROR    | agent_memory_system.utils.logger:error:182 | 处理WebSocket消息失败: 'NoneType' object has no attribute 'get'
2025-07-20 08:38:56.183 | INFO     | agent_memory_system.utils.logger:info:176 | 处理完成，准备发送响应: {'type': 'error', 'data': {'message': '处理消息失败', 'detail': "'NoneType' object has no attribute 'get'"}, 'timestamp': '2025-07-20T08:38:56.183789', 'success': True, 'error': None}
2025-07-20 08:38:56.185 | INFO     | agent_memory_system.utils.logger:info:176 | 响应已发送
2025-07-20 08:38:59.563 | INFO     | agent_memory_system.utils.logger:info:176 | 收到WebSocket消息: {'type': 'message', 'content': 'hi', 'timestamp': '2025-07-20T08:38:51.160Z'}
2025-07-20 08:38:59.564 | INFO     | agent_memory_system.utils.logger:info:176 | 处理后的消息格式: {'type': 'message', 'data': {'content': 'hi'}, 'timestamp': '2025-07-20T08:38:51.160Z'}
2025-07-20 08:38:59.565 | INFO     | agent_memory_system.utils.logger:info:176 | 解析后的消息: type=message, data={'content': 'hi'}
2025-07-20 08:38:59.565 | INFO     | agent_memory_system.utils.logger:info:176 | 开始处理消息类型: message
2025-07-20 08:38:59.565 | INFO     | agent_memory_system.utils.logger:info:176 | process_websocket_message: 开始处理消息类型 message
2025-07-20 08:38:59.565 | INFO     | agent_memory_system.utils.logger:info:176 | 处理聊天消息，内容: hi
2025-07-20 08:38:59.566 | ERROR    | agent_memory_system.utils.logger:error:182 | 向量检索失败: 'MemoryQuery' object has no attribute 'content'
2025-07-20 08:38:59.567 | ERROR    | agent_memory_system.utils.logger:error:182 | 图检索失败: 'MemoryQuery' object has no attribute 'memory_ids'
2025-07-20 08:38:59.592 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:39:03.592 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:39:07.593 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM API调用失败: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-07-20 08:39:07.594 | ERROR    | agent_memory_system.utils.logger:error:182 | LLM调用失败: RetryError[<Future at 0x7935b8122940 state=finished raised APIRemovedInV1>]
2025-07-20 08:39:07.594 | ERROR    | agent_memory_system.utils.logger:error:182 | 存储记忆失败: store_memory() missing 1 required positional argument: 'memory_type'
2025-07-20 08:39:07.596 | INFO     | agent_memory_system.utils.logger:info:176 | 处理完成，准备发送响应: {'type': 'message', 'data': {'content': '抱歉，我暂时无法处理您的请求。错误信息: RetryError[<Future at 0x7935b8122940 state=finished raised APIRemovedInV1>]'}, 'timestamp': '2025-07-20T08:39:07.595937', 'success': True, 'error': None}
2025-07-20 08:39:07.596 | INFO     | agent_memory_system.utils.logger:info:176 | 响应已发送
2025-07-20 09:18:43.241 | INFO     | agent_memory_system.utils.logger:info:176 | WebSocket客户端断开: 99d2ea45-bce6-4eff-9ba6-4586c40472f0
2025-07-20 09:25:09.881 | INFO     | agent_memory_system.utils.logger:info:176 | WebSocket客户端连接: 712c290c-939b-4959-9cbc-f94f7e388bf6
2025-07-20 09:25:44.838 | INFO     | agent_memory_system.utils.logger:info:176 | WebSocket客户端断开: 712c290c-939b-4959-9cbc-f94f7e388bf6
2025-07-20 09:25:44.940 | INFO     | agent_memory_system.utils.logger:info:176 | 缓存存储连接池已关闭
2025-07-20 09:25:44.941 | INFO     | agent_memory_system.utils.logger:info:176 | 记忆管理器已关闭
2025-07-20 09:25:44.942 | INFO     | agent_memory_system.utils.logger:info:176 | 缓存存储连接池已关闭
2025-07-20 09:25:44.942 | INFO     | agent_memory_system.utils.logger:info:176 | 记忆管理器已关闭
